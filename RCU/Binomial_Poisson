# Análise da distribuição dos dados:
# 
# Para verificar os se or dados se enquandrão quais tipo de distribuição foram utilizado dois testes  de dispersão e compração do *log-likelihood ratios*.
# se Q-quidrado for > que o level aceita-se o Ha - distribuição Binomial negativa
# 

#bibliotecas necessárias:
library(MASS) # para regressão binomial negativa
library(survival)
library(sandwich)
library(AER) # Para disperssão
library(pscl)

# 1. Proporção_RCU_BRASIL
## oDTest
RCU_BRlm <- glm.nb(`Proporção_RCU_BRASIL` ~ Ano, data = RCU)
odTest(RCU_BRlm) # precisa ser glm.nb

## plot
plot(RCU$Ano,RCU$`Proporção_RCU_BRASIL`)

# 2.  cx/RCU_Acumulativo

CX_Ac <- glm.nb(`cx/RCU_Anual_Acumulativo` ~ Ano, data = RCU)
odTest(CX_Ac) # precisa ser glm.nb

plot(RCU$Ano,RCU$`cx/RCU_Anual_Acumulativo`)

# 3.  cx/RCU_nãoAcumulativo

CX_NA <- glm.nb(`cx/RCU_Anual_nãoAcumulativo` ~ Ano, data = RCU)
odTest(CX_NA)

plot(RCU$Ano,RCU$`cx/RCU_Anual_nãoAcumulativo`)

# 4.  Hosp/RCU_Acumulativo
Hosp_Ac <- glm.nb(`Hosp/RCU_Acumulativo` ~ Ano, data = RCU)
odTest(Hosp_Ac)

plot(RCU$Ano,RCU$`Hosp/RCU_Acumulativo`)


# 5.  Hosp/RCU_nãoAcumulativo
Hosp_NA <- glm.nb(`Hosp/RCU_Acumulativo` ~ Ano, data = RCU)
odTest(Hosp_NA)

plot(RCU$Ano,RCU$`Hosp/RCU_nãoAcumulativo`)
